/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   syscall.c                                          :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: fcadet <fcadet@student.42.fr>              +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2023/01/19 10:05:33 by fcadet            #+#    #+#             */
/*   Updated: 2023/01/20 21:57:28 by fcadet           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "syscall.h"

static const sysc_t			SYSC[SYSC_NB] = {
	{	.name = "_llseek",
	   	.id = { -1, 140, -1, 140 },
	 	.args = { AT_UINT, AT_UINT, AT_UINT,
			AT_HEX, AT_UINT, 0 },
	},{	.name = "_newselect",
	   	.id = { -1, 142, -1, 142 },
	 	.args = { AT_INT, AT_HEX, AT_HEX,
			AT_HEX, AT_HEX, 0 },
	},{	.name = "_sysctl",
	   	.id = { 156, 149, -1, 149 },
	 	.args = { AT_HEX, 0 },
	},{	.name = "accept",
	   	.id = { 43, 285, 202, -1 },
	 	.args = { AT_INT, AT_HEX, AT_HEX, 0 },
	},{	.name = "accept4",
	   	.id = { 288, 366, 242, 364 },
	 	.args = { AT_INT, AT_HEX, AT_HEX, AT_INT, 0 },
	},{	.name = "access",
	   	.id = { 21, 33, -1, 33 },
	 	.args = { AT_STR, AT_INT, 0 },
	},{	.name = "acct",
	   	.id = { 163, 51, 89, 51 },
	 	.args = { AT_STR, 0 },
	},{	.name = "add_key",
	   	.id = { 248, 309, 217, 286 },
	 	.args = { AT_STR, AT_STR, AT_HEX,
			AT_UINT, AT_INT, 0 },
	},{	.name = "adjtimex",
	   	.id = { 159, 124, 171, 124 },
	 	.args = { AT_HEX, 0 },
	},{	.name = "afs_syscall",
	   	.id = { 183, -1, -1, 137 },
	 	.args = { 0 },
	},{	.name = "alarm",
	   	.id = { 37, -1, -1, 27 },
	 	.args = { AT_UINT, 0 },
	},{	.name = "arch_prctl",
	   	.id = { 158, -1, -1, 384 },
	 	.args = { AT_INT, AT_HEX, 0 },
	},{	.name = "arm_fadvise64_64",
	   	.id = { -1, 270, -1, -1 },
	 	.args = { AT_INT, AT_UINT, AT_UINT, AT_INT, 0 },
	},{	.name = "arm_sync_file_range",
	   	.id = { -1, 341, -1, -1 },
	 	.args = { AT_INT, AT_UINT, AT_UINT, AT_UINT, 0 },
	},{	.name = "bdflush",
	   	.id = { -1, 134, -1, 134 },
	 	.args = { AT_INT, AT_INT, 0 },
	},{	.name = "bind",
	   	.id = { 49, 282, 200, 361 },
	 	.args = { AT_INT, AT_HEX, AT_INT },
	},{	.name = "bpf",
	   	.id = { 321, 386, 280, 357 },
	 	.args = { AT_INT, AT_HEX, AT_UINT },
	},{	.name = "break",
	   	.id = { -1, -1, -1, 17 },
	 	.args = { 0 },
	},{	.name = "brk",
	   	.id = { 12, 45, 214, 45 },
	 	.args = { AT_UINT, 0 },
	},{	.name = "capget",
	   	.id = { 125, 184, 90, 184 },
	 	.args = { AT_HEX, AT_HEX, 0 },
	},{	.name = "capset",
	   	.id = { 126, 185, 91, 185 },
	 	.args = { AT_HEX, AT_HEX, 0 },
	},{	.name = "chdir",
	   	.id = { 80, 12, 49, 12 },
	 	.args = { AT_STR, 0 },
	},{	.name = "chmod",
	   	.id = { 90, 15, -1, 15 },
	 	.args = { AT_STR, AT_OCT, 0 },
	},{	.name = "chown",
	   	.id = { 92, 182, -1, 182 },
	 	.args = { AT_STR, AT_UINT, AT_UINT, 0 },
	},{	.name = "chown32",
	   	.id = { -1, 212, -1, 212 },
	 	.args = { AT_STR, AT_UINT, AT_UINT, 0 },
	},{	.name = "chroot",
	   	.id = { 161, 61, 51, 61 },
	 	.args = { AT_STR, 0 },
	},{	.name = "clock_adjtime",
	   	.id = { 305, 372, 266, 343 },
	 	.args = { AT_UINT, AT_HEX, 0 },
	},{	.name = "clock_getres",
	   	.id = {229, 264, 114, 266 },
	 	.args = { AT_UINT, AT_HEX, 0 },
	},{	.name = "clock_gettime",
	   	.id = { 228, 263, 113, 265 },
	 	.args = { AT_INT, AT_HEX, 0 },
	},{	.name = "clock_nanosleep",
	   	.id = { 230, 265, 115, 267 },
	 	.args = { AT_HEX, AT_HEX, 0 },
	},{	.name = "clock_settime",
	   	.id = { 227, 262, 112, 264 },
	 	.args = { AT_UINT, AT_HEX, 0 },
	},{	.name = "clone",
	   	.id = { 56, 120, 220, 120 },
	 	.args = { AT_UINT, AT_UINT, AT_HEX, AT_HEX, AT_UINT, 0 },
	},{	.name = "close",
	   	.id = { 3, 6, 57, 6 },
	 	.args = { AT_UINT, 0 },
	},{	.name = "connect",
	   	.id = { 42, 283, 203, 362 },
	 	.args = { AT_INT, AT_HEX, AT_INT, 0 },
	},{	.name = "copy_file_range",
	   	.id = { 326, 391, 285, 377 },
	 	.args = { AT_INT, AT_HEX, AT_INT,
			AT_HEX, AT_UINT, AT_UINT },
	},{	.name = "creat",
	   	.id = { 85, 8, -1, 8 },
	 	.args = { AT_STR, AT_OCT, 0 },
	},{	.name = "create_module",
	   	.id = { 174, -1, -1, 127 },
	 	.args = { AT_STR, AT_UINT, 0 },
	},{	.name = "delete_module",
	   	.id = { 176, 129, 106, 129 },
	 	.args = { AT_STR, AT_UINT, 0 },
	},{	.name = "dup",
	   	.id = { 32, 41, 23, 41 },
	 	.args = { AT_UINT, 0 },
	},{	.name = "dup2",
	   	.id = { 33, 63, -1, 63 },
	 	.args = { AT_UINT, AT_UINT, 0 },
	},{	.name = "dup3",
	   	.id = { 292, 358, 24, 330 },
	 	.args = { AT_UINT, AT_UINT, AT_INT, 0 },
	},{	.name = "epoll_create",
	   	.id = { 213, 250, -1, 254 },
	 	.args = { AT_INT, 0 },
	},{	.name = "epoll_create1",
	   	.id = { 291, 357, 20, 329 },
	 	.args = { AT_INT, 0 },
	},{	.name = "epoll_ctl",
	   	.id = { 233, 251, 21, 255 },
	 	.args = { AT_INT, AT_INT, AT_INT, AT_HEX, 0 },
	},{	.name = "epoll_ctl_old",
	   	.id = { 214, -1, -1, -1 },
	 	.args = { 0 },
	},{	.name = "epoll_pwait",
	   	.id = { 281, 346, 22, 319 },
	 	.args = { AT_INT, AT_HEX, AT_INT,
			AT_INT, AT_HEX, AT_UINT },
	},{	.name = "epoll_wait",
	   	.id = { 232, 252, -1, 256 },
	 	.args = { AT_INT, AT_HEX, AT_INT, AT_INT, 0 },
	},{	.name = "epoll_wait_old",
	   	.id = { 215, -1, -1, -1 },
	 	.args = { 0 },
	},{	.name = "eventfd",
	   	.id = { 284, 351, -1, 323 },
	 	.args = { AT_UINT, 0 },
	},{	.name = "eventfd2",
	   	.id = { 290, 356, 19, 328 },
	 	.args = { AT_UINT, AT_INT, 0 },
	},{	.name = "execve",
	   	.id = { 59, 11, 221, 11 },
	 	.args = { AT_STR, AT_LST, AT_LST, 0 },
	},{	.name = "execveat",
	   	.id = { 322, 387, 281, 358 },
	 	.args = { AT_INT, AT_STR, AT_LST,
			AT_LST, AT_INT, 0 },
	},{	.name = "exit",
	   	.id = { 60, 1, 93, 1 },
	 	.args = { AT_INT, 0 },
	},{	.name = "exit_group",
	   	.id = { 231, 248, 94, 252 },
	 	.args = { AT_INT, 0 },
	},{	.name = "faccessat",
	   	.id = { 269, 334, 48, 307 },
	 	.args = { AT_INT, AT_STR, AT_INT, 0},
	},{	.name = "fadvise64",
	   	.id = { 221, -1, 223, 250 },
	 	.args = { AT_INT, AT_UINT, AT_UINT, AT_INT, 0 },
	},{	.name = "fadvise64_64",
	   	.id = { -1, -1, -1, 272 },
	 	.args = { AT_INT, AT_UINT, AT_UINT, AT_INT, 0 },
	},{	.name = "fallocate",
	   	.id = { 285, 352, 47, 324 },
	 	.args = { AT_INT, AT_INT, AT_UINT, AT_UINT, 0 },
	},{	.name = "fanotify_init",
	   	.id = { 300, 367, 262, 338 },
	 	.args = { AT_UINT, AT_UINT, 0 },
	},{	.name = "fanotify_mark",
	   	.id = { 301, 368, 263, 339 },
	 	.args = { AT_INT, AT_UINT, AT_UINT,
			AT_INT, AT_STR, 0 },
	},{	.name = "fchdir",
	   	.id = { 81, 133, 50, 133 },
	 	.args = { AT_INT, 0 },
	},{	.name = "fchmod",
	   	.id = { 91, 94, 52, 94 },
	 	.args = { AT_UINT, AT_OCT, 0 },
	},{	.name = "fchmodat",
	   	.id = { 268, 333, 53, 306 },
	 	.args = { AT_INT, AT_STR, AT_OCT, 0 },
	},{	.name = "fchown",
	   	.id = { 93, 95, 55, 95 },
	 	.args = { AT_UINT, AT_UINT, AT_UINT, 0 },
	},{	.name = "fchown32",
	   	.id = {-1, 207, -1, 207 },
	 	.args = { AT_INT, AT_UINT, AT_UINT, 0 },
	},{	.name = "fchownat",
	   	.id = { 260, 325, 54, 298 },
	 	.args = { AT_INT, AT_STR, AT_UINT,
			AT_UINT, AT_INT, 0 },
	},{	.name = "fcntl",
	   	.id = { 72, 55, 25, 55 },
	 	.args = { AT_UINT, AT_UINT, AT_UINT, 0 },
	},{	.name = "fcntl64",
	   	.id = { -1, 221, -1, 221 },
	 	.args = { AT_UINT, AT_UINT, AT_UINT, 0 },
	},{	.name = "fdatasync",
	   	.id = { 75, 148, 83, 148 },
	 	.args = { AT_INT },
	},{	.name = "fgetxattr",
	   	.id = { 193, 231, 10, 231 },
	 	.args = { AT_INT, AT_STR, AT_HEX, AT_UINT, 0 },
	},{	.name = "finit_module",
	   	.id = { 313, 379, 273, 350 },
	 	.args = { AT_INT, AT_STR, AT_INT, 0 },
	},{	.name = "flistxattr",
	   	.id = { 196, 234, 13, 234 },
	 	.args = { AT_INT, AT_STR, AT_UINT, 0 },
	},{	.name = "flock",
	   	.id = { 73, 143, 32, 143 },
	 	.args = { AT_UINT, AT_UINT, 0 },
	},{	.name = "fork",
	   	.id = { 57, 2, -1, 2 },
	 	.args = { 0 },
	},{	.name = "fremovexattr",
	   	.id = { 199, 237, 16, 237 },
	 	.args = { AT_INT, AT_STR, 0 },
	},{	.name = "fsetxattr",
	   	.id = { 190, 228, 7, 228 },
	 	.args = { AT_INT, AT_STR, AT_HEX,
			AT_UINT, AT_INT, 0 },
	},{	.name = "fstat",
	   	.id = { 5, 108, 80, 108 },
	 	.args = { AT_UINT, AT_HEX, 0 },
	},{	.name = "fstat64",
	   	.id = { -1, 197, -1, 197 },
	 	.args = { AT_UINT, AT_HEX, 0 },
	},{	.name = "fstatat64",
	   	.id = { -1, 327, -1, 300 },
	 	.args = { AT_INT, AT_STR, AT_HEX, AT_INT, 0 },
	},{	.name = "fstatfs",
	   	.id = { 138, 100, 44, 100 },
	 	.args = { AT_UINT, AT_HEX, 0 },
	},{	.name = "fstatfs64",
	   	.id = { -1, 267, -1, 269 },
	 	.args = { AT_UINT, AT_UINT, AT_HEX, 0 },
	},{	.name = "fsync",
	   	.id = { 74, 118, 82, 118 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ftime",
	   	.id = {-1, -1, -1, 35 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ftruncate",
	   	.id = {77, 93, 46, 93 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ftruncate64",
	   	.id = {-1, 194, -1, 194 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "futex",
	   	.id = {202, 240, 98, 240 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "futimesat",
	   	.id = {261, 326, -1, 299 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "get_kernel_syms",
	   	.id = {177, -1, -1, 130 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "get_mempolicy",
	   	.id = {239, 320, 236, 275 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "get_robust_list",
	   	.id = {274, 339, 100, 312 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "get_thread_area",
	   	.id = {211, -1, -1, 244 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getcpu",
	   	.id = {309, 345, 168, 318 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getcwd",
	   	.id = {79, 183, 17, 183 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getdents",
	   	.id = {78, 141, -1, 141 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getdents64",
	   	.id = {217, 217, 61, 220 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getegid",
	   	.id = {108, 50, 177, 50 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getegid32",
	   	.id = {-1, 202, -1, 202 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "geteuid",
	   	.id = {107, 49, 175, 49 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "geteuid32",
	   	.id = {-1, 201, -1, 201 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getgid",
	   	.id = {104, 47, 176, 47 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getgid32",
	   	.id = {-1, 200, -1, 200 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getgroups",
	   	.id = {115, 80, 158, 80 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getgroups32",
	   	.id = {-1, 205, -1, 205 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getitimer",
	   	.id = {36, 105, 102, 105 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getpeername",
	   	.id = {52, 287, 205, 368 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getpgid",
	   	.id = {121, 132, 155, 132 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getpgrp",
	   	.id = {111, 65, -1, 65 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getpid",
	   	.id = {39, 20, 172, 20 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getpmsg",
	   	.id = {181, -1, -1, 188 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getppid",
	   	.id = {110, 64, 173, 64 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getpriority",
	   	.id = {140, 96, 141, 96 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getrandom",
	   	.id = {318, 384, 278, 355 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getresgid",
	   	.id = {120, 171, 150, 171 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getresgid32",
	   	.id = {-1, 211, -1, 211 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getresuid",
	   	.id = {118, 165, 148, 165 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getresuid32",
	   	.id = {-1, 209, -1, 209 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getrlimit",
	   	.id = {97, -1, 163, 76 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getrusage",
	   	.id = {98, 77, 165, 77 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getsid",
	   	.id = {124, 147, 156, 147 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getsockname",
	   	.id = {51, 286, 204, 367 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getsockopt",
	   	.id = {55, 295, 209, 365 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "gettid",
	   	.id = {186, 224, 178, 224 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "gettimeofday",
	   	.id = {96, 78, 169, 78 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getuid",
	   	.id = {102, 24, 174, 24 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getuid32",
	   	.id = {-1, 199, -1, 199 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "getxattr",
	   	.id = {191, 229, 8, 229 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "gtty",
	   	.id = {-1, -1, -1, 32 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "idle",
	   	.id = {-1, -1, -1, 112 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "init_module",
	   	.id = {175, 128, 105, 128 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "inotify_add_watch",
	   	.id = {254, 317, 27, 292 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "inotify_init",
	   	.id = {253, 316, -1, 291 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "inotify_init1",
	   	.id = {294, 360, 26, 332 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "inotify_rm_watch",
	   	.id = {255, 318, 28, 293 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "io_cancel",
	   	.id = {210, 247, 3, 249 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "io_destroy",
	   	.id = {207, 244, 1, 246 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "io_getevents",
	   	.id = {208, 245, 4, 247 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "io_setup",
	   	.id = {206, 243, 0, 245 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "io_submit",
	   	.id = {209, 246, 2, 248 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ioctl",
	   	.id = {16, 54, 29, 54 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ioperm",
	   	.id = {173, -1, -1, 101 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "iopl",
	   	.id = {172, -1, -1, 110 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ioprio_get",
	   	.id = {252, 315, 31, 290 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ioprio_set",
	   	.id = {251, 314, 30, 289 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ipc",
	   	.id = {-1, -1, -1, 117 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "kcmp",
	   	.id = {312, 378, 272, 349 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "kexec_file_load",
	   	.id = {320, -1, -1, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "kexec_load",
	   	.id = {246, 347, 104, 283 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "keyctl",
	   	.id = {250, 311, 219, 288 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "kill",
	   	.id = {62, 37, 129, 37 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "lchown",
	   	.id = {94, 16, -1, 16 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "lchown32",
	   	.id = {-1, 198, -1, 198 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "lgetxattr",
	   	.id = {192, 230, 9, 230 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "link",
	   	.id = {86, 9, -1, 9 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "linkat",
	   	.id = {265, 330, 37, 303 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "listen",
	   	.id = {50, 284, 201, 363 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "listxattr",
	   	.id = {194, 232, 11, 232 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "llistxattr",
	   	.id = {195, 233, 12, 233 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "lock",
	   	.id = {-1, -1, -1, 53 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "lookup_dcookie",
	   	.id = {212, 249, 18, 253 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "lremovexattr",
	   	.id = {198, 236, 15, 236 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "lseek",
	   	.id = {8, 19, 62, 19 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "lsetxattr",
	   	.id = {189, 227, 6, 227 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "lstat",
	   	.id = {6, 107, -1, 107 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "lstat64",
	   	.id = {-1, 196, -1, 196 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "madvise",
	   	.id = {28, 220, 233, 219 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mbind",
	   	.id = {237, 319, 235, 274 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "membarrier",
	   	.id = {324, 389, 283, 375 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "memfd_create",
	   	.id = {319, 385, 279, 356 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "migrate_pages",
	   	.id = {256, -1, 238, 294 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mincore",
	   	.id = {27, 219, 232, 218 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mkdir",
	   	.id = {83, 39, -1, 39 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mkdirat",
	   	.id = {258, 323, 34, 296 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mknod",
	   	.id = {133, 14, -1, 14 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mknodat",
	   	.id = {259, 324, 33, 297 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mlock",
	   	.id = {149, 150, 228, 150 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mlock2",
	   	.id = {325, 390, 284, 376 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mlockall",
	   	.id = {151, 152, 230, 152 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mmap",
	   	.id = {9, -1, 222, 90 },
	 	.args = { AT_HEX, AT_UINT, AT_INT,
			AT_INT, AT_INT, AT_UINT },
	},{	.name = "mmap2",
	   	.id = {-1, 192, -1, 192 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "modify_ldt",
	   	.id = {154, -1, -1, 123 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mount",
	   	.id = {165, 21, 40, 21 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "move_pages",
	   	.id = {279, 344, 239, 317 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mprotect",
	   	.id = {10, 125, 226, 125 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mpx",
	   	.id = {-1, -1, -1, 56 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mq_getsetattr",
	   	.id = {245, 279, 185, 282 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mq_notify",
	   	.id = {244, 278, 184, 281 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mq_open",
	   	.id = {240, 274, 180, 277 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mq_timedreceive",
	   	.id = {243, 277, 183, 280 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mq_timedsend",
	   	.id = {242, 276, 182, 279 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mq_unlink",
	   	.id = {241, 275, 181, 278 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "mremap",
	   	.id = {25, 163, 216, 163 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "msgctl",
	   	.id = {71, 304, 187, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "msgget",
	   	.id = {68, 303, 186, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "msgrcv",
	   	.id = {70, 302, 188, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "msgsnd",
	   	.id = {69, 301, 189, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "msync",
	   	.id = {26, 144, 227, 144 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "munlock",
	   	.id = {150, 151, 229, 151 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "munlockall",
	   	.id = {152, 153, 231, 153 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "munmap",
	   	.id = {11, 91, 215, 91 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "name_to_handle_at",
	   	.id = {303, 370, 264, 341 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "nanosleep",
	   	.id = {35, 162, 101, 162 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "newfstatat",
	   	.id = { 262, -1, 79, -1 },
	 	.args = { AT_INT, AT_STR, AT_HEX, AT_INT, 0 },
	},{	.name = "nfsservctl",
	   	.id = {180, 169, 42, 169 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "nice",
	   	.id = {-1, 34, -1, 34 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "oldfstat",
	   	.id = {-1, -1, -1, 28 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "oldlstat",
	   	.id = {-1, -1, -1, 84 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "oldolduname",
	   	.id = {-1, -1, -1, 59 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "oldstat",
	   	.id = {-1, -1, -1, 18 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "olduname",
	   	.id = {-1, -1, -1, 109 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "open",
	   	.id = {2, 5, -1, 5 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "open_by_handle_at",
	   	.id = {304, 371, 265, 342 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "openat",
	   	.id = {257, 322, 56, 295 },
	 	.args = { AT_INT, AT_STR, AT_INT, AT_UINT, 0 },
	},{	.name = "pause",
	   	.id = {34, 29, -1, 29 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pciconfig_iobase",
	   	.id = {-1, 271, -1, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pciconfig_read",
	   	.id = {-1, 272, -1, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pciconfig_write",
	   	.id = {-1, 273, -1, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "perf_event_open",
	   	.id = {298, 364, 241, 336 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "personality",
	   	.id = {135, 136, 92, 136 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pipe",
	   	.id = {22, 42, -1, 42 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pipe2",
	   	.id = {293, 359, 59, 331 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pivot_root",
	   	.id = {155, 218, 41, 217 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pkey_alloc",
	   	.id = {330, 395, 289, 381 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pkey_free",
	   	.id = {331, 396, 290, 382 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pkey_mprotect",
	   	.id = {329, 394, 288, 380 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "poll",
	   	.id = {7, 168, -1, 168 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ppoll",
	   	.id = {271, 336, 73, 309 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "prctl",
	   	.id = {157, 172, 167, 172 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pread64",
	   	.id = {17, 180, 67, 180 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "preadv",
	   	.id = {295, 361, 69, 333 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "preadv2",
	   	.id = {327, 392, 286, 378 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "prlimit64",
	   	.id = {302, 369, 261, 340 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "process_vm_readv",
	   	.id = {310, 376, 270, 347 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "process_vm_writev",
	   	.id = {311, 377, 271, 348 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "prof",
	   	.id = {-1, -1, -1, 44 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "profil",
	   	.id = {-1, -1, -1, 98 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pselect6",
	   	.id = {270, 335, 72, 308 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ptrace",
	   	.id = {101, 26, 117, 26 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "putpmsg",
	   	.id = {182, -1, -1, 189 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pwrite64",
	   	.id = {18, 181, 68, 181 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pwritev",
	   	.id = {296, 362, 70, 334 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "pwritev2",
	   	.id = {328, 393, 287, 379 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "query_module",
	   	.id = {178, -1, -1, 167 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "quotactl",
	   	.id = {179, 131, 60, 131 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "read",
	   	.id = {0, 3, 63, 3 },
	 	.args = { AT_INT, AT_STR, AT_UINT, AT_IGN },
	},{	.name = "readahead",
	   	.id = {187, 225, 213, 225 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "readdir",
	   	.id = {-1, -1, -1, 89 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "readlink",
	   	.id = {89, 85, -1, 85 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "readlinkat",
	   	.id = {267, 332, 78, 305 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "readv",
	   	.id = {19, 145, 65, 145 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "reboot",
	   	.id = {169, 88, 142, 88 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "recv",
	   	.id = {-1, 291, -1, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "recvfrom",
	   	.id = {45, 292, 207, 371 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "recvmmsg",
	   	.id = {299, 365, 243, 337 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "recvmsg",
	   	.id = {47, 297, 212, 372 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "remap_file_pages",
	   	.id = {216, 253, 234, 257 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "removexattr",
	   	.id = {197, 235, 14, 235 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "rename",
	   	.id = {82, 38, -1, 38 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "renameat",
	   	.id = {264, 329, 38, 302 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "renameat2",
	   	.id = {316, 382, 276, 353 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "request_key",
	   	.id = {249, 310, 218, 287 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "restart_syscall",
	   	.id = {219, 0, 128, 0 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "rmdir",
	   	.id = {84, 40, -1, 40 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "rt_sigaction",
	   	.id = {13, 174, 134, 174 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "rt_sigpending",
	   	.id = {127, 176, 136, 176 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "rt_sigprocmask",
	   	.id = {14, 175, 135, 175 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "rt_sigqueueinfo",
	   	.id = {129, 178, 138, 178 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "rt_sigreturn",
	   	.id = {15, 173, 139, 173 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "rt_sigsuspend",
	   	.id = {130, 179, 133, 179 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "rt_sigtimedwait",
	   	.id = {128, 177, 137, 177 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "rt_tgsigqueueinfo",
	   	.id = {297, 363, 240, 335 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sched_get_priority_max",
	   	.id = {146, 159, 125, 159 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sched_get_priority_min",
	   	.id = {147, 160, 126, 160 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sched_getaffinity",
	   	.id = {204, 242, 123, 242 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sched_getattr",
	   	.id = {315, 381, 275, 352 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sched_getparam",
	   	.id = {143, 155, 121, 155 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sched_getscheduler",
	   	.id = {145, 157, 120, 157 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sched_rr_get_interval",
	   	.id = {148, 161, 127, 161 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sched_setaffinity",
	   	.id = {203, 241, 122, 241 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sched_setattr",
	   	.id = {314, 380, 274, 351 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sched_setparam",
	   	.id = {142, 154, 118, 154 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sched_setscheduler",
	   	.id = {144, 156, 119, 156 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sched_yield",
	   	.id = {24, 158, 124, 158 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "seccomp",
	   	.id = {317, 383, 277, 354 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "security",
	   	.id = {185, -1, -1, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "select",
	   	.id = {23, -1, -1, 82 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "semctl",
	   	.id = {66, 300, 191, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "semget",
	   	.id = {64, 299, 190, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "semop",
	   	.id = {65, 298, 193, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "semtimedop",
	   	.id = {220, 312, 192, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "send",
	   	.id = {-1, 289, -1, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sendfile",
	   	.id = {40, 187, 71, 187 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sendfile64",
	   	.id = {-1, 239, -1, 239 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sendmmsg",
	   	.id = {307, 374, 269, 345 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sendmsg",
	   	.id = {46, 296, 211, 370 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sendto",
	   	.id = {44, 290, 206, 369 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "set_mempolicy",
	   	.id = {238, 321, 237, 276 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "set_robust_list",
	   	.id = {273, 338, 99, 311 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "set_thread_area",
	   	.id = {205, -1, -1, 243 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "set_tid_address",
	   	.id = {218, 256, 96, 258 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setdomainname",
	   	.id = {171, 121, 162, 121 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setfsgid",
	   	.id = {123, 139, 152, 139 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setfsgid32",
	   	.id = {-1, 216, -1, 216 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setfsuid",
	   	.id = {122, 138, 151, 138 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setfsuid32",
	   	.id = {-1, 215, -1, 215 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setgid",
	   	.id = {106, 46, 144, 46 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setgid32",
	   	.id = {-1, 214, -1, 214 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setgroups",
	   	.id = {116, 81, 159, 81 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setgroups32",
	   	.id = {-1, 206, -1, 206 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sethostname",
	   	.id = {170, 74, 161, 74 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setitimer",
	   	.id = {38, 104, 103, 104 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setns",
	   	.id = {308, 375, 268, 346 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setpgid",
	   	.id = {109, 57, 154, 57 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setpriority",
	   	.id = {141, 97, 140, 97 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setregid",
	   	.id = {114, 71, 143, 71 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setregid32",
	   	.id = {-1, 204, -1, 204 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setresgid",
	   	.id = {119, 170, 149, 170 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setresgid32",
	   	.id = {-1, 210, -1, 210 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setresuid",
	   	.id = {117, 164, 147, 164 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setresuid32",
	   	.id = {-1, 208, -1, 208 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setreuid",
	   	.id = {113, 70, 145, 70 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setreuid32",
	   	.id = {-1, 203, -1, 203 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setrlimit",
	   	.id = {160, 75, 164, 75 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setsid",
	   	.id = {112, 66, 157, 66 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setsockopt",
	   	.id = {54, 294, 208, 366 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "settimeofday",
	   	.id = {164, 79, 170, 79 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setuid",
	   	.id = {105, 23, 146, 23 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setuid32",
	   	.id = {-1, 213, -1, 213 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "setxattr",
	   	.id = {188, 226, 5, 226 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sgetmask",
	   	.id = {-1, -1, -1, 68 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "shmat",
	   	.id = {30, 305, 196, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "shmctl",
	   	.id = {31, 308, 195, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "shmdt",
	   	.id = {67, 306, 197, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "shmget",
	   	.id = {29, 307, 194, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "shutdown",
	   	.id = {48, 293, 210, 373 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sigaction",
	   	.id = {-1, 67, -1, 67 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sigaltstack",
	   	.id = {131, 186, 132, 186 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "signal",
	   	.id = {-1, -1, -1, 48 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "signalfd",
	   	.id = {282, 349, -1, 321 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "signalfd4",
	   	.id = {289, 355, 74, 327 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sigpending",
	   	.id = {-1, 73, -1, 73 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sigprocmask",
	   	.id = {-1, 126, -1, 126 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sigreturn",
	   	.id = {-1, 119, -1, 119 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sigsuspend",
	   	.id = {-1, 72, -1, 72 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "socket",
	   	.id = {41, 281, 198, 359 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "socketcall",
	   	.id = {-1, -1, -1, 102 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "socketpair",
	   	.id = {53, 288, 199, 360 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "splice",
	   	.id = {275, 340, 76, 313 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ssetmask",
	   	.id = {-1, -1, -1, 69 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "stat",
	   	.id = {4, 106, -1, 106 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "stat64",
	   	.id = {-1, 195, -1, 195 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "statfs",
	   	.id = {137, 99, 43, 99 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "statfs64",
	   	.id = {-1, 266, -1, 268 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "statx",
	   	.id = {332, 397, 291, 383 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "stime",
	   	.id = {-1, -1, -1, 25 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "stty",
	   	.id = {-1, -1, -1, 31 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "swapoff",
	   	.id = {168, 115, 225, 115 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "swapon",
	   	.id = {167, 87, 224, 87 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "symlink",
	   	.id = {88, 83, -1, 83 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "symlinkat",
	   	.id = {266, 331, 36, 304 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sync",
	   	.id = {162, 36, 81, 36 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sync_file_range",
	   	.id = {277, -1, 84, 314 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sync_file_range2",
	   	.id = {-1, 341, -1, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "syncfs",
	   	.id = {306, 373, 267, 344 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sysfs",
	   	.id = {139, 135, -1, 135 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "sysinfo",
	   	.id = {99, 116, 179, 116 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "syslog",
	   	.id = {103, 103, 116, 103 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "tee",
	   	.id = {276, 342, 77, 315 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "tgkill",
	   	.id = {234, 268, 131, 270 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "time",
	   	.id = {201, -1, -1, 13 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "timer_create",
	   	.id = {222, 257, 107, 259 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "timer_delete",
	   	.id = {226, 261, 111, 263 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "timer_getoverrun",
	   	.id = {225, 260, 109, 262 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "timer_gettime",
	   	.id = {224, 259, 108, 261 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "timer_settime",
	   	.id = {223, 258, 110, 260 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "timerfd_create",
	   	.id = {283, 350, 85, 322 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "timerfd_gettime",
	   	.id = {287, 354, 87, 326 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "timerfd_settime",
	   	.id = {286, 353, 86, 325 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "times",
	   	.id = {100, 43, 153, 43 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "tkill",
	   	.id = {200, 238, 130, 238 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "truncate",
	   	.id = {76, 92, 45, 92 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "truncate64",
	   	.id = {-1, 193, -1, 193 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "tuxcall",
	   	.id = {184, -1, -1, -1 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ugetrlimit",
	   	.id = {-1, 191, -1, 191 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ulimit",
	   	.id = {-1, -1, -1, 58 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "umask",
	   	.id = {95, 60, 166, 60 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "umount",
	   	.id = {-1, -1, -1, 22 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "umount2",
	   	.id = {166, 52, 39, 52 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "uname",
	   	.id = {63, 122, 160, 122 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "unlink",
	   	.id = {87, 10, -1, 10 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "unlinkat",
	   	.id = {263, 328, 35, 301 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "unshare",
	   	.id = {272, 337, 97, 310 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "uselib",
	   	.id = {134, 86, -1, 86 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "userfaultfd",
	   	.id = {323, 388, 282, 374 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "ustat",
	   	.id = {136, 62, -1, 62 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "utime",
	   	.id = {132, -1, -1, 30 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "utimensat",
	   	.id = {280, 348, 88, 320 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "utimes",
	   	.id = {235, 269, -1, 271 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "vfork",
	   	.id = {58, 190, -1, 190 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "vhangup",
	   	.id = {153, 111, 58, 111 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "vm86",
	   	.id = {-1, -1, -1, 166 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "vm86old",
	   	.id = {-1, -1, -1, 113 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "vmsplice",
	   	.id = {278, 343, 75, 316 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "vserver",
	   	.id = {236, 313, -1, 273 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "wait4",
	   	.id = {61, 114, 260, 114 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "waitid",
	   	.id = {247, 280, 95, 284 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "waitpid",
	   	.id = {-1, -1, -1, 7 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	},{	.name = "write",
	   	.id = {1, 4, 64, 4 },
	 	.args = { AT_INT, AT_STR, AT_UINT, AT_IGN },
	},{	.name = "writev",
		.id = {20, 146, 66, 146 },
	 	.args = { 0, 0, 0, 0, 0, 0 },
	}
};

static arch_t		g_arch = 0;

void				arch_set(arch_t arch) {
	g_arch = arch;
}

static char			*rep_esc(char *str) {
	static char		new_str[BUFF_SZ * 2];
	const char		esc_c[] = "abtnvfr";
	int				i, j;

	bzero(new_str, BUFF_SZ * 2);
	for (i = 0, j = 0; i < BUFF_SZ && str[i]; ++i) {
		if (str[i] > 6 && str[i] < 14) {
			new_str[j++] = '\\';
			new_str[j++] = esc_c[str[i] - 7];
			continue;
		} else if (str[i] < ' ' || str[i] > '~')
			break;
		new_str[j++] = str[i];
	}
	return (new_str);
}

static void		print_oct(uint64_t val, int init) {
	if (init)
		printf("0");
	if (val / 8)
		print_oct(val / 8, 0);
	printf("%ld", val % 8);
}

static int	get_mem(int pid) {
	char			mem_path[BUFF_SZ];

	sprintf(mem_path, "/proc/%d/mem", pid);
	return (open(mem_path, O_RDONLY));
}

static char	*get_str(int fd, char *off) {
	int				i;
	char			str[BUFF_SZ + 2];
	static char		result[BUFF_SZ * 5];

	if (lseek(fd, (uint64_t)off, SEEK_SET) < 0)
		return (NULL);
	for (i = 0; i < BUFF_SZ + 2; ++i) {
		if (read(fd, str + i, 1) != 1)
			return (NULL);
		if (!str[i])
			break;
	}
	sprintf(result, "\"%.*s\"%s", BUFF_SZ, rep_esc(str),
			i > BUFF_SZ ? "..." : "");
	return (result);
}

static char	*get_lst(int fd, char **off) {
	int				i;
	char			*str;
	static char		*offs[BUFF_SZ + 2];
	static char		strs[(BUFF_SZ + 2) * BUFF_SZ * 5];

	if (lseek(fd, (uint64_t)off, SEEK_SET) < 0)
		return (NULL);
	for (i = 0; i < BUFF_SZ + 2; ++i) {
		if (read(fd, offs + i, sizeof(uint64_t))
				!= sizeof(uint64_t))
			return (NULL);
		if (!offs[i])
			break;
	}
	bzero(strs, BUFF_SZ * 5 * (BUFF_SZ + 2));
	strcat(strs, "[");
	for (i = 0; i < BUFF_SZ + 2 && offs[i]; ++i) {
		if (!(str = get_str(fd, offs[i])))
			return (NULL);
		if (i)
			strcat(strs, ", ");
		strcat(strs, str);
	}
	if (i > BUFF_SZ)
		strcat(strs, ", ...");
	strcat(strs, "]");
	return (strs);
}

static int	close_ret(int fd, int ret) {
	close(fd);
	return (ret);
}

void	set_color(char *color, col_op_t op) {
	static char			col_stack[BUFF_SZ][COLOR_SZ];
	static uint8_t		init = 1, stack_sz = 0;

	if (init) {
		init = 0;
		set_color(WHITE, CO_PUSH);
	}
	switch (op) {
		case CO_PUSH:
			strncpy(col_stack[stack_sz++],
				color, COLOR_SZ);
			printf("%s", color);
			break;
		default:
			printf("%s", col_stack[--stack_sz - 1]);
	}
}

int			sysc_print(void *regs, int pid) {
	const sysc_t	*sysc = NULL;
	char			*str;
	int				i, fd;

	for (i = 0; i < SYSC_NB; ++i)
		if ((int)((uint64_t *)regs)[8] == SYSC[i].id[g_arch])
			sysc = &SYSC[i];
	if (!sysc || (fd = get_mem(pid)) < 0)
		return (-1);
	set_color(YELLOW, CO_PUSH);
	printf("%s(", sysc->name);
	for (i = 0; i < ARG_NB; ++i) {
		switch (sysc->args[i]) {
			case AT_UINT:
				set_color(RED, CO_PUSH);
				printf("%lu", ((uint64_t *)regs)[i]);
				break;
			case AT_INT:
				set_color(RED, CO_PUSH);
				printf("%ld", ((int64_t *)regs)[i]);
				break;
			case AT_STR:
				if (!(str = get_str(fd,
						(char *)((uint64_t *)regs)[i])))
					close_ret(fd, -1);
				set_color(GREEN, CO_PUSH);
				printf("%s", str);
				break;
			case AT_LST:
				if (!(str = get_lst(fd,
						(void *)((uint64_t *)regs)[i])))
					close_ret(fd, -1);
				set_color(CYAN, CO_PUSH);
				printf("%s", str);
				break;
			case AT_HEX:
				set_color(BLUE, CO_PUSH);
				if (((uint64_t *)regs)[i])
					printf("0x%lx", ((uint64_t *)regs)[i]);
				else
					printf("NULL");
				break;
			case AT_OCT:
				set_color(BLUE, CO_PUSH);
				print_oct(((uint64_t *)regs)[i], 1);
				break;
			default:
				goto ign;
		}
		set_color(NULL, CO_POP);
		printf(", ");
	}
	ign:
		printf(i ? "\b\b) " : ") ");
		set_color(NULL, CO_POP);
		return (close_ret(fd, 0));
}
